# ฟีเจอร์ "บวกยอดผิด สร้างใบสำคัญจ่ายใหม่"

## ภาพรวม
ฟีเจอร์นี้ช่วยให้ผู้ใช้สามารถสร้างใบสำคัญจ่ายใหม่จากใบสั่งงานที่มีอยู่ โดยระบบจะคำนวณยอดรวมจากค่าใช้จ่ายต่างๆ และสร้างใบสำคัญจ่ายที่มีข้อมูลครบถ้วน

## ฟีเจอร์หลัก

### 1. การบวกยอดผิด
- แสดงปุ่ม "บวกยอดผิด" ในใบสั่งงานที่มีค่าใช้จ่าย
- คำนวณยอดรวมจากค่าใช้จ่ายต่างๆ อัตโนมัติ:
  - ค่ารับตู้
  - ค่าคืนตู้
  - ค่าปะยาง
  - ค่าค้างคืน
  - ค่าฝากตู้
  - ค่าน้ำมัน

### 2. การสร้างใบสำคัญจ่ายใหม่
- สร้างใบสำคัญจ่ายใหม่จากข้อมูลใบสั่งงาน
- กรอกข้อมูลเริ่มต้นอัตโนมัติ:
  - เลขที่ใบสำคัญจ่าย
  - วันที่
  - พนักงานขับรถ
  - รายละเอียดงาน
  - ยอดค่ารับ+คืนตู้

### 3. การแสดงข้อมูลครบถ้วน
- แสดงข้อมูลใบสั่งงานต้นฉบับในทุกส่วน:
  - ฟอร์มสร้างใบสำคัญจ่าย
  - การ์ดแสดงรายการ
  - หน้า Preview และพิมพ์

## ข้อมูลที่แสดงในใบสำคัญจ่าย

### ข้อมูลทั่วไป
- เลขที่ใบสั่งงาน
- เล่มที่
- เบอร์ตู้
- เบอร์ซีล
- ขนาดตู้
- สถานที่รับ/ส่ง/คืนตู้

### รายละเอียดค่าใช้จ่าย
- ค่ารับตู้
- ค่าคืนตู้
- ค่าปะยาง
- ค่าค้างคืน
- ค่าฝากตู้
- ค่าน้ำมัน
- ยอดรวมจากใบสั่งงาน

### ข้อมูลเพิ่มเติม
- เบอร์บุ๊คกิ้ง
- เอเย่นต์
- วันที่รับ/ส่ง/คืนตู้
- คำสั่งพิเศษ

## วิธีการใช้งาน

### ขั้นตอนที่ 1: สร้างใบสั่งงาน
1. ไปที่หน้า "ใบสั่งงาน"
2. สร้างใบสั่งงานใหม่หรือแก้ไขใบสั่งงานที่มีอยู่
3. กรอกข้อมูลค่าใช้จ่ายต่างๆ

### ขั้นตอนที่ 2: บวกยอดผิด
1. ในหน้า "ใบสั่งงาน" คลิกปุ่ม "บวกยอดผิด" ในใบสั่งงานที่มีค่าใช้จ่าย
2. ระบบจะเปิดฟอร์มใบสำคัญจ่ายใหม่พร้อมข้อมูลที่กรอกไว้แล้ว

### ขั้นตอนที่ 3: แก้ไขและบันทึก
1. ตรวจสอบและแก้ไขข้อมูลตามต้องการ
2. เพิ่มรายการอื่นๆ หากจำเป็น
3. คลิก "บันทึก" เพื่อสร้างใบสำคัญจ่ายใหม่

### ขั้นตอนที่ 4: ดูและพิมพ์
1. ไปที่หน้า "ใบสำคัญจ่าย" เพื่อดูรายการที่สร้างใหม่
2. คลิก "ดู" เพื่อดูตัวอย่างและสั่งพิมพ์
3. ใบสำคัญจ่ายจะมีข้อมูลครบถ้วนจากใบสั่งงานต้นฉบับ

## การคำนวณยอด

### ยอดรวมจากใบสั่งงาน
```
ยอดรวม = ค่ารับตู้ + ค่าคืนตู้ + ค่าปะยาง + ค่าค้างคืน + ค่าฝากตู้ + ค่าน้ำมัน
```

### ยอดจ่ายสุทธิ
```
ยอดค่าขนส่งรวม = ราคา/เที่ยว + ค่ารับ+คืนตู้
หัก 1% ค่าขนส่ง = ราคา/เที่ยว × 0.01
ยอดจ่ายสุทธิ = ยอดค่าขนส่งรวม - หัก 1% - เงินเบิก
```

## ข้อดีของฟีเจอร์

1. **ประหยัดเวลา**: ไม่ต้องกรอกข้อมูลซ้ำ
2. **ลดข้อผิดพลาด**: ข้อมูลถูกคัดลอกจากใบสั่งงานต้นฉบับ
3. **ติดตามได้**: มีการอ้างอิงถึงใบสั่งงานต้นฉบับ
4. **ข้อมูลครบถ้วน**: แสดงข้อมูลทั้งหมดที่เกี่ยวข้อง
5. **คำนวณอัตโนมัติ**: ระบบคำนวณยอดรวมให้อัตโนมัติ

## การอ้างอิงข้อมูล

ใบสำคัญจ่ายที่สร้างจาก "บวกยอดผิด" จะมีการอ้างอิงถึงใบสั่งงานต้นฉบับผ่าน:
- `sourceJobOrderId`: ID ของใบสั่งงานต้นฉบับ
- หมายเหตุที่ระบุเลขที่ใบสั่งงานต้นฉบับ
- การแสดงข้อมูลใบสั่งงานต้นฉบับในทุกส่วนของระบบ 