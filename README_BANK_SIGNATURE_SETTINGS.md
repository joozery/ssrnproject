# การตั้งค่าข้อมูลธนาคารและลายเซ็น

## ภาพรวม

ระบบได้เพิ่มฟีเจอร์การตั้งค่าข้อมูลธนาคารและลายเซ็นในหน้าตั้งค่าระบบ ซึ่งจะช่วยให้สามารถ:

1. **จัดการข้อมูลบัญชีธนาคาร** - เก็บข้อมูลธนาคาร ชื่อบัญชี เลขบัญชี และสาขา
2. **อัปโหลดลายเซ็น** - อัปโหลดรูปภาพลายเซ็นสำหรับใช้ในเอกสารต่างๆ
3. **แสดงข้อมูลในเอกสาร** - แสดงข้อมูลธนาคารและลายเซ็นในเอกสารต่างๆ อัตโนมัติ

## ฟีเจอร์ที่เพิ่มเข้ามา

### 1. ข้อมูลธนาคาร
- **ชื่อธนาคาร** - ชื่อธนาคารที่ใช้
- **ชื่อบัญชี** - ชื่อบัญชีธนาคาร
- **เลขบัญชี** - เลขบัญชีธนาคาร
- **สาขา** - สาขาธนาคาร

### 2. ลายเซ็น
- **อัปโหลดลายเซ็น** - อัปโหลดรูปภาพลายเซ็น (PNG, JPG ขนาดไม่เกิน 5MB)
- **ลบลายเซ็น** - ลบลายเซ็นที่อัปโหลดแล้ว
- **แสดงตัวอย่าง** - แสดงตัวอย่างลายเซ็นที่อัปโหลด

## การใช้งาน

### 1. เข้าสู่หน้าตั้งค่า
1. ไปที่เมนู "ตั้งค่าระบบ"
2. เลื่อนลงไปดูส่วน "ข้อมูลธนาคาร" และ "ลายเซ็น"

### 2. ตั้งค่าข้อมูลธนาคาร
1. กรอกข้อมูลธนาคาร:
   - ชื่อธนาคาร (เช่น ธนาคารกรุงเทพ จำกัด (มหาชน))
   - ชื่อบัญชี (ชื่อบัญชีธนาคาร)
   - เลขบัญชี (เช่น 123-4-56789-0)
   - สาขา (เช่น สาขาลาดกระบัง)

### 3. อัปโหลดลายเซ็น
1. คลิกที่พื้นที่อัปโหลดลายเซ็น
2. เลือกไฟล์รูปภาพลายเซ็น (PNG, JPG)
3. รอการอัปโหลดเสร็จสิ้น
4. ตรวจสอบตัวอย่างลายเซ็นที่แสดง

### 4. บันทึกการตั้งค่า
1. คลิกปุ่ม "บันทึกการเปลี่ยนแปลง"
2. รอการบันทึกเสร็จสิ้น

## การแสดงผลในเอกสาร

### 1. ใบแจ้งหนี้ (Invoice)
- แสดงข้อมูลธนาคารในส่วน "ข้อมูลการชำระเงิน"
- แสดงลายเซ็นในส่วนท้ายเอกสาร

### 2. ใบเสนอราคา (Quotation)
- แสดงข้อมูลธนาคารในส่วน "ข้อมูลการชำระเงิน"
- แสดงลายเซ็นในส่วนท้ายเอกสาร

### 3. ใบสั่งงาน (Job Order)
- แสดงข้อมูลธนาคารในส่วน "ข้อมูลการชำระเงิน"
- แสดงลายเซ็นในส่วนลายเซ็นผู้สั่งงาน

### 4. ใบเบิกเงิน (Payment Voucher)
- แสดงข้อมูลธนาคารบริษัทในส่วน "ข้อมูลบัญชีธนาคารบริษัท"
- แสดงลายเซ็นในส่วนลายเซ็นผู้จ่าย

## การตั้งค่าฐานข้อมูล

### Migration
รัน migration เพื่อเพิ่มฟิลด์ใหม่ในตาราง `company_info`:

```bash
cd backendssr
node scripts/run-bank-signature-migration.js
```

### ฟิลด์ที่เพิ่ม
- `bank_name` - ชื่อธนาคาร
- `bank_account_name` - ชื่อบัญชี
- `bank_account_number` - เลขบัญชี
- `bank_branch` - สาขา
- `signature_url` - URL รูปภาพลายเซ็น
- `signature_public_id` - Public ID ของลายเซ็นใน Cloudinary

## API Endpoints

### 1. อัปโหลดลายเซ็น
```
POST /company-info/upload-signature
Content-Type: multipart/form-data
Body: signature (file)
```

### 2. ลบลายเซ็น
```
DELETE /company-info/delete-signature/:publicId
```

### 3. อัปเดตข้อมูลบริษัท
```
PUT /company-info
Body: {
  bank_name: string,
  bank_account_name: string,
  bank_account_number: string,
  bank_branch: string,
  signature_url: string,
  signature_public_id: string
}
```

## การจัดการไฟล์

### Cloudinary Configuration
ลายเซ็นจะถูกอัปโหลดไปยัง Cloudinary ในโฟลเดอร์ `ssrn-signatures`

### การแปลงรูปภาพ
- ขนาดสูงสุด: 200x100 pixels
- คุณภาพ: auto
- รูปแบบ: PNG, JPG

## ข้อควรระวัง

1. **ขนาดไฟล์** - ลายเซ็นต้องมีขนาดไม่เกิน 5MB
2. **รูปแบบไฟล์** - รองรับเฉพาะ PNG และ JPG
3. **การแสดงผล** - ข้อมูลธนาคารจะแสดงเฉพาะเมื่อมีการกรอกข้อมูล
4. **ลายเซ็น** - ลายเซ็นจะแสดงเฉพาะเมื่อมีการอัปโหลด

## การแก้ไขปัญหา

### ลายเซ็นไม่แสดง
1. ตรวจสอบว่าได้อัปโหลดลายเซ็นแล้ว
2. ตรวจสอบการเชื่อมต่อ Cloudinary
3. ตรวจสอบ URL ของลายเซ็น

### ข้อมูลธนาคารไม่แสดง
1. ตรวจสอบว่าได้กรอกข้อมูลธนาคารแล้ว
2. ตรวจสอบการบันทึกข้อมูล
3. ตรวจสอบการเชื่อมต่อฐานข้อมูล

## การพัฒนาต่อ

### ฟีเจอร์ที่อาจเพิ่มในอนาคต
1. **หลายบัญชีธนาคาร** - รองรับหลายบัญชีธนาคาร
2. **ลายเซ็นหลายคน** - รองรับลายเซ็นหลายคน
3. **เทมเพลตลายเซ็น** - เทมเพลตลายเซ็นสำเร็จรูป
4. **การตรวจสอบลายเซ็น** - ระบบตรวจสอบลายเซ็นดิจิทัล 